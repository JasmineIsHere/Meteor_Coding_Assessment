# Meteor_Coding_Assessment
### Jasmine Tan Jia Min

[Assessment Instructions](https://go.gov.sg/meteor-tech-assessment)

## Running in Local Environment
1. Clone this repository in preferred local device
2. Install Go [here](https://go.dev/doc/install)
3. Install Gin package, the HTTP Web Framework used in this project with
   `go get -u github.com/gin-gonic/gin`
4. In the project folder, run `go mod tidy && go mod vendor`
5. Run project with `go run .`
6. Check if service is up using the [healthcheck endpoint](http://localhost:8080)

## Project Layout
### controllers
The HTTP handlers for processing the requests.

### daos
The Data Access layer to interact with the data storage.

### domains
Contains the business domain objects.

### models
Models are generated by SQLBoiler. You shouldn't modify any file in this folder.

## Assumptions
### Database Setup
To reduce the amount of setup necessary, I have decided to host the database on an AWS RDS so there is no need to spin up another DB instance on one's local machine. <br><br>
However, in the event that the connection to the cloud database is not stable, one can choose to connect to their own database instance and change the configuration in the `sqlboiler.toml` file.
The sql file containing the database schema can be found in the **/resources** folder.

To regenerate the models, [sqlboiler](https://github.com/volatiletech/sqlboiler) is necessary. <br>
To get started with sqlboiler:
1. Install sqlboiler with the commands:
```
# Go 1.16 and above:
go install github.com/volatiletech/sqlboiler/v4@latest
go install github.com/volatiletech/sqlboiler/v4/drivers/sqlboiler-psql@latest

# Go 1.15 and below:
# Install sqlboiler v4 and the postgresql driver (mysql, mssql, sqlite3 also available)
# NOTE: DO NOT run this inside another Go module (like your project) as it will
# pollute your go.mod with a bunch of stuff you don't want and your binary
# will not get installed.
GO111MODULE=on go get -u -t github.com/volatiletech/sqlboiler/v4
GO111MODULE=on go get github.com/volatiletech/sqlboiler/v4/drivers/sqlboiler-psql
```
2. Run command: `sqlboiler -c sqlboiler.toml --wipe mysql`

### Task 1: Create Household
`POST http://localhost:8080/households` <br>

Body: application/json <br>
```
{
    "type": "Landed"
}
```

cURL: `curl --location --request POST 'http://localhost:8080/households' \
--header 'Content-Type: application/json' \
--data-raw '{
"type": "Landed"
}'`
<br>

### Task 2: Add a family member to household
`POST http://localhost:8080/households/{householdId}` <br>

Body: application/json <br>
```
{
    "name": "Rocket",
    "gender": "Male",
    "marital_status": "Single",
    "occupation_types": "Unemployed",
    "annual_income": 10000.00,
    "dob": "2015-07-11T00:00:00.000Z"
}
```

cURL: `curl --location --request POST 'http://localhost:8080/households/8' \
--header 'Content-Type: application/json' \
--data-raw '{
"name": "Rocket",
"gender": "Male",
"marital_status": "Single",
"occupation_types": "Unemployed",
"annual_income": 10000.00,
"dob": "2015-07-11T00:00:00.000Z"
}'`

#### Assumptions Made:
   **ASSUMPTION 1:** User knows the householdID of the household they want to add a family member to. <br>
   **ASSUMPTION 2:** Family members are added one by one into the household. So when adding couples, the first partner does not have spouseID yet as his/her partner has not been added into the DB yet. <br>
<br>

### Task 3: List all households
`GET http://localhost:8080/households/all` <br>

Body: nil <br>

cURL: `curl --location --request GET 'http://localhost:8080/households/all' \
--data-raw ''`

#### Assumptions Made:
   **ASSUMPTION 1:** The fields listed in 3b. are the fields expected to be shown in the response body <br>
<br>

### Task 4: Search for a specific household
`GET http://localhost:8080/households/{householdId}` <br>

Body: nil <br>

cURL: `curl --location --request GET 'http://localhost:8080/households/8' \
--data-raw ''`

#### Assumptions Made:
**ASSUMPTION 1:** The fields listed in 4b. are the fields expected to be shown in the response body <br>
<br>

### Task 5: List the households and qualifying family members
#### Assumptions Made:
1. Student Encouragement Bonus <br>
   `GET http://localhost:8080/grants/seb` <br>
   **ASSUMPTION 1:** ELIGIBILITY = (at least one member whose occupationType = "Student" AND age > 16 years) AND total household income < 200,000 <br>
   **ASSUMPTION 2:** a person's age depends on whether a person's birthday has passed <br>
   **ASSUMPTION 3:** Households incomes of less than $200,000 refers to the family's total annual income <br>
<br>
2. Multigeneration Scheme <br>
   `GET http://localhost:8080/grants/mgs` <br>
   
   **ASSUMPTION 1**: ELIGIBILITY = at least ONE member whose age is < 18 or > 55 which will make everyone in the household qualified <br>
   **ASSUMPTION 2**: Households incomes of less than $150,000 refers to the family's total annual income <br>
<br>
3. Elder Bonus <br>
   `GET http://localhost:8080/grants/eb` <br>

<br>
4. Baby Sunshine Grant <br>
   `GET http://localhost:8080/grants/bsg` <br>
<br>
5. YOLO GST Grant <br>
   `GET http://localhost:8080/grants/yolo` <br>
   
   **ASSUMPTION 1**: Households incomes of less than $100,000 refers to the family's total annual income <br>

<br>
